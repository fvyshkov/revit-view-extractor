# Python Revit View Exporter

Этот скрипт позволяет извлекать изображения видов из файлов Revit с помощью Python.

## Возможности

- Извлечение списка всех видов из файла Revit
- Фильтрация видов по имени и типу
- Экспорт выбранных видов в формате PNG
- Настройка разрешения и размера экспортируемых изображений

## Требования

- Revit 2019 или новее
- pyRevit или RevitPythonShell

## Установка

### Вариант 1: pyRevit (рекомендуется)

1. Установите [pyRevit](https://github.com/eirannejad/pyRevit/releases)
2. Создайте новую кнопку в pyRevit:
   - Откройте pyRevit > Настройки > Новый скрипт
   - Вставьте код из файла `python_revit_exporter.py`
   - Сохраните скрипт

### Вариант 2: RevitPythonShell

1. Установите [RevitPythonShell](https://github.com/architecture-building-systems/revitpythonshell/releases)
2. Откройте RevitPythonShell в Revit
3. Загрузите скрипт `python_revit_exporter.py`
4. Запустите скрипт

## Использование

1. Запустите скрипт из pyRevit или RevitPythonShell
2. Выберите виды, которые хотите экспортировать:
   - Используйте фильтр по имени для поиска конкретных видов
   - Используйте выпадающий список типов для фильтрации по типу вида
   - Используйте "Select All" для выбора всех видов
3. Нажмите кнопку "Export"
4. Выберите папку для сохранения изображений
5. Дождитесь завершения экспорта

## Настройка параметров экспорта

Вы можете изменить параметры экспорта, отредактировав следующие строки в функции `export_views_to_images`:

```python
options.PixelSize = 2000  # Ширина изображения в пикселях
options.ImageResolution = ImageResolution.DPI_300  # Разрешение
options.HLRandWFViewsFileType = ImageFileType.PNG  # Формат файла
```

## Решение проблем

### Скрипт не запускается

- Убедитесь, что скрипт запускается из Revit через pyRevit или RevitPythonShell
- Проверьте, что у вас есть права на запись в выбранную папку

### Некоторые виды не экспортируются

- Не все виды в Revit могут быть экспортированы как изображения
- Виды, которые не могут быть напечатаны (CanBePrinted = False), будут пропущены
- Шаблоны видов и системные виды также пропускаются

## Дополнительно

Для автоматизации без открытия Revit можно использовать:

1. **Revit Batch Processor** - инструмент для пакетной обработки файлов Revit
2. **Dynamo Player** - для запуска скриптов Dynamo без открытия Dynamo
3. **Design Automation API** - для облачной обработки файлов Revit
